#!/usr/bin/env bash
# Provide the domain name received from the promo code
domain_name="realsetup.tech"

# Configure DNS records with an A entry
echo -e "server {\n\tlisten 80;\n\tserver_name $domain_name;\n\tlocation / {\n\t\tproxy_pass http://172.17.0.3:80;\n\t}\n}" | sudo tee /etc/nginx/sites-available/$domain_name > /dev/null
sudo ln -s /etc/nginx/sites-available/$domain_name /etc/nginx/sites-enabled/

# Restart Nginx to apply the changes
sudo /etc/init.d/nginx restart

# Display the configured domain name
echo "OK"

# Check registrar information using whoisxmlapi.com
response=$(curl -s "https://whois.whoisxmlapi.com/api/v1?apiKey=YOUR_API_KEY&domainName=$domain_name" | jq -r '.registrarName')

# Verify registrarName in the API response
if [ "$response" == "Dotserve Inc" ]; then
    echo "#student.web-01"
else
    echo "Registrar information not as expected"
fi

# Display the configured domain name
echo $domain_name
